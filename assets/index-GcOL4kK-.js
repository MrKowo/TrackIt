import{r as o,j as e,L as ne,A as be,F as je,C as rt,a as nt,b as it,P as lt,c as ot,p as ct,d as dt,e as ut,i as mt,T as xt,f as bt,g as gt,R as ht,h as ie,k as Le,l as ke,m as ye,n as pt,X as Ne,q as ft,S as Pe,s as Ce,t as wt,u as vt,v as zt,w as Re,x as Ve,y as jt,z as me,B as kt,D as yt,E as Nt,G as Ct,H as Dt,I as St,J as Fe,U as $t,K as Oe,M as Tt,N as Et,O as At,Q as Ue,V as Mt,W as It,Y as Lt,Z as Pt,_ as Rt,$ as Vt,a0 as Ft,a1 as Ot,a2 as Ut,a3 as Bt}from"./vendor-BMbJthfe.js";import{i as Gt,g as Ht,a as Wt,o as Yt,s as qt,c as Kt,b as _t,q as fe,d as re,e as Q,f as De,h as we,w as Be,j as V,k as Ee,u as xe,l as Ge,m as te,n as He,p as Jt,r as pe}from"./firebase-BpqAtrUN.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function s(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=s(r);fetch(r.href,n)}})();const Xt={apiKey:"AIzaSyAvBYzH_B2CY7e5tqJkHqj83hT62POyVT4",authDomain:"tracker-7953b.firebaseapp.com",projectId:"tracker-7953b",storageBucket:"tracker-7953b.firebasestorage.app",messagingSenderId:"277129788312",appId:"1:277129788312:web:ed28693354f33d1d6609ed"},We=Gt(Xt),U=Ht(We),E=Wt(We),Ye=o.createContext(),Zt=({children:t})=>{const[a,s]=o.useState(null),[i,r]=o.useState(!0);return o.useEffect(()=>{const n=Yt(U,l=>{s(l),r(!1)});return()=>n()},[]),i?e.jsx("div",{className:"h-screen w-full flex items-center justify-center bg-zinc-50 dark:bg-zinc-900",children:e.jsx(ne,{className:"w-10 h-10 animate-spin text-blue-500"})}):e.jsx(Ye.Provider,{value:{user:a},children:t})},W=()=>o.useContext(Ye),Qt=()=>{const[t,a]=o.useState(""),[s,i]=o.useState(""),[r,n]=o.useState(!1),[l,x]=o.useState(""),c=async u=>{u.preventDefault(),n(!0),x("");try{try{await qt(U,t,s)}catch(d){if(d.code==="auth/user-not-found"||d.code==="auth/invalid-credential")await Kt(U,t,s);else throw d}}catch(d){console.error(d),x(d.message.replace("Firebase:","").trim()),n(!1)}},g=async()=>{n(!0);try{await _t(U)}catch(u){console.error(u),x("Could not sign in as guest."),n(!1)}};return e.jsx("div",{className:"flex items-center justify-center min-h-screen p-4 bg-zinc-50 dark:bg-zinc-900",children:e.jsxs("div",{className:"rounded-2xl shadow-2xl p-8 w-full max-w-md border bg-white dark:bg-zinc-800 border-zinc-200 dark:border-zinc-700",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"bg-blue-600 w-16 h-16 rounded-2xl mx-auto flex items-center justify-center mb-6 shadow-lg shadow-blue-600/30",children:e.jsx(be,{className:"text-white w-8 h-8"})}),e.jsx("h2",{className:"text-3xl font-bold mb-2 text-zinc-900 dark:text-white",children:"TrackIt"}),e.jsx("p",{className:"text-zinc-500 dark:text-zinc-400",children:"Sign in to sync your progress"})]}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-1",children:"Email"}),e.jsx("input",{type:"email",required:!0,className:"w-full px-4 py-3 rounded-xl outline-none transition-all focus:ring-2 focus:ring-blue-500 bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 dark:text-white",value:t,onChange:u=>a(u.target.value),placeholder:"hello@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-1",children:"Password"}),e.jsx("input",{type:"password",required:!0,className:"w-full px-4 py-3 rounded-xl outline-none transition-all focus:ring-2 focus:ring-blue-500 bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 dark:text-white",value:s,onChange:u=>i(u.target.value),placeholder:"••••••••"})]}),l&&e.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 text-red-500 rounded-lg text-sm",children:l}),e.jsx("button",{type:"submit",disabled:r,className:"w-full py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-medium shadow-lg shadow-blue-600/20 transition-all transform active:scale-95 disabled:opacity-50 disabled:active:scale-100 flex items-center justify-center",children:r?e.jsx(ne,{className:"w-5 h-5 animate-spin"}):"Continue"})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx("button",{type:"button",onClick:g,disabled:r,className:"w-full py-3 mt-4 border-2 border-zinc-300 dark:border-zinc-700 text-zinc-700 dark:text-zinc-300 font-bold rounded-xl hover:bg-zinc-50 dark:hover:bg-zinc-800 transition-all",children:"Or continue as Guest"})})]})})},ve={blue:{label:"Blue",primary:"bg-blue-600 hover:bg-blue-700 text-white shadow-blue-600/20",secondary:"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400",border:"border-blue-200 dark:border-blue-800",text:"text-blue-600 dark:text-blue-400",ring:"focus:ring-blue-500",chartLine:"#2563EB",chartFill:"rgba(37, 99, 235, 0.1)",chartPoint:"#2563EB",activeNav:"bg-blue-50 dark:bg-blue-900/20 border-blue-500 ring-1 ring-blue-500 dark:border-blue-500",activeNavText:"text-blue-700 dark:text-blue-400"},purple:{label:"Purple",primary:"bg-purple-600 hover:bg-purple-700 text-white shadow-purple-600/20",secondary:"bg-purple-50 dark:bg-purple-900/20 text-purple-600 dark:text-purple-400",border:"border-purple-200 dark:border-purple-800",text:"text-purple-600 dark:text-purple-400",ring:"focus:ring-purple-500",chartLine:"#9333EA",chartFill:"rgba(147, 51, 234, 0.1)",chartPoint:"#9333EA",activeNav:"bg-purple-50 dark:bg-purple-900/20 border-purple-500 ring-1 ring-purple-500 dark:border-purple-500",activeNavText:"text-purple-700 dark:text-purple-400"},emerald:{label:"Emerald",primary:"bg-emerald-600 hover:bg-emerald-700 text-white shadow-emerald-600/20",secondary:"bg-emerald-50 dark:bg-emerald-900/20 text-emerald-600 dark:text-emerald-400",border:"border-emerald-200 dark:border-emerald-800",text:"text-emerald-600 dark:text-emerald-400",ring:"focus:ring-emerald-500",chartLine:"#059669",chartFill:"rgba(5, 150, 105, 0.1)",chartPoint:"#059669",activeNav:"bg-emerald-50 dark:bg-emerald-900/20 border-emerald-500 ring-1 ring-emerald-500 dark:border-emerald-500",activeNavText:"text-emerald-700 dark:text-emerald-400"},amber:{label:"Amber",primary:"bg-amber-500 hover:bg-amber-600 text-white shadow-amber-500/20",secondary:"bg-amber-50 dark:bg-amber-900/20 text-amber-600 dark:text-amber-400",border:"border-amber-200 dark:border-amber-800",text:"text-amber-600 dark:text-amber-400",ring:"focus:ring-amber-500",chartLine:"#D97706",chartFill:"rgba(217, 119, 6, 0.1)",chartPoint:"#D97706",activeNav:"bg-amber-50 dark:bg-amber-900/20 border-amber-500 ring-1 ring-amber-500 dark:border-amber-500",activeNavText:"text-amber-700 dark:text-amber-400"},rose:{label:"Rose",primary:"bg-rose-600 hover:bg-rose-700 text-white shadow-rose-600/20",secondary:"bg-rose-50 dark:bg-rose-900/20 text-rose-600 dark:text-rose-400",border:"border-rose-200 dark:border-rose-800",text:"text-rose-600 dark:text-rose-400",ring:"focus:ring-rose-500",chartLine:"#E11D48",chartFill:"rgba(225, 29, 72, 0.1)",chartPoint:"#E11D48",activeNav:"bg-rose-50 dark:bg-rose-900/20 border-rose-500 ring-1 ring-rose-500 dark:border-rose-500",activeNavText:"text-rose-700 dark:text-rose-400"},indigo:{label:"Indigo",primary:"bg-indigo-600 hover:bg-indigo-700 text-white shadow-indigo-600/20",secondary:"bg-indigo-50 dark:bg-indigo-900/20 text-indigo-600 dark:text-indigo-400",border:"border-indigo-200 dark:border-indigo-800",text:"text-indigo-600 dark:text-indigo-400",ring:"focus:ring-indigo-500",chartLine:"#4F46E5",chartFill:"rgba(79, 70, 229, 0.1)",chartPoint:"#4F46E5",activeNav:"bg-indigo-50 dark:bg-indigo-900/20 border-indigo-500 ring-1 ring-indigo-500 dark:border-indigo-500",activeNavText:"text-indigo-700 dark:text-indigo-400"}},q=[{name:"Red",class:"bg-red-100 text-red-800 border-red-200 dark:bg-red-900/40 dark:text-red-300 dark:border-red-800",dot:"bg-red-500"},{name:"Green",class:"bg-emerald-100 text-emerald-800 border-emerald-200 dark:bg-emerald-900/40 dark:text-emerald-300 dark:border-emerald-800",dot:"bg-emerald-500"},{name:"Blue",class:"bg-blue-100 text-blue-800 border-blue-200 dark:bg-blue-900/40 dark:text-blue-300 dark:border-blue-800",dot:"bg-blue-500"},{name:"Yellow",class:"bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-900/40 dark:text-yellow-300 dark:border-yellow-800",dot:"bg-yellow-500"},{name:"Purple",class:"bg-purple-100 text-purple-800 border-purple-200 dark:bg-purple-900/40 dark:text-purple-300 dark:border-purple-800",dot:"bg-purple-500"},{name:"Orange",class:"bg-orange-100 text-orange-800 border-orange-200 dark:bg-orange-900/40 dark:text-orange-300 dark:border-orange-800",dot:"bg-orange-500"},{name:"Pink",class:"bg-pink-100 text-pink-800 border-pink-200 dark:bg-pink-900/40 dark:text-pink-300 dark:border-pink-800",dot:"bg-pink-500"},{name:"Indigo",class:"bg-indigo-100 text-indigo-800 border-indigo-200 dark:bg-indigo-900/40 dark:text-indigo-300 dark:border-indigo-800",dot:"bg-indigo-500"}],qe=t=>{if(!t||t.length===0)return q[0];const a=new Set(t.map(i=>i.colorClass)),s=q.filter(i=>!a.has(i.class));return s.length>0?s[0]:q[Math.floor(Math.random()*q.length)]},Ae=t=>new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric"}),I=t=>{if(!t)return"";if(typeof t=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(t))return t;const a=new Date(t);return`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}-${String(a.getDate()).padStart(2,"0")}`},Ke=(t,a)=>{const s=new Date(t,a,1);return{daysInMonth:new Date(t,a+1,0).getDate(),startDay:s.getDay()}},_e=(t,a="average")=>{if(!t||t.length===0)return 0;const s=t.map(Number).filter(i=>!isNaN(i));return s.length===0?0:a==="sum"?s.reduce((i,r)=>i+r,0):s.reduce((i,r)=>i+r,0)/s.length},Je=(t,a)=>{if(!a||!t||t.length===0)return{streak:0,lastDate:t&&t.length>0?I(t[0]):null};const s=[...new Set(t.map(I))].sort((c,g)=>new Date(g)-new Date(c));if(s.length===0)return{streak:0,lastDate:null};const i=s[0],r=I(new Date);if((new Date(r).getTime()-new Date(i).getTime())/(1e3*3600*24)>1)return{streak:0,lastDate:i};let l=0,x=null;for(const c of s){if(x===null){l=1,x=c;continue}if((new Date(x).getTime()-new Date(c).getTime())/(1e3*3600*24)===1)l++,x=c;else break}return{streak:l,lastDate:i}},ze=(t,a,s=null)=>{if(t==null)return{isHit:null,diff:0,label:""};if(a.goalDirection==="target"&&a.targetValue!==null&&a.targetValue!==void 0){const i=Math.abs(t-a.targetValue),r=a.tolerance||0,n=i<=r;return{isHit:n,diff:i,label:n?"Target Hit":`${i.toFixed(1)} off`}}if(a.goalDirection==="increase"){if(s===null)return{isHit:null,diff:0,label:"No prev data"};const i=t>=s,r=t-s;return{isHit:i,diff:r,label:i?"Improved":"Decreased"}}if(a.goalDirection==="decrease"){if(s===null)return{isHit:null,diff:0,label:"No prev data"};const i=t<=s,r=s-t;return{isHit:i,diff:r,label:i?"Improved":"Increased"}}return{isHit:null,diff:0,label:""}},Se=(t,a)=>{if(!t||t.length<2||!a.targetValue||a.goalDirection==="none"||a.goalDirection===void 0)return null;const s=[...t].sort((h,f)=>new Date(h.date)-new Date(f.date)),i=new Date(s[0].date).getTime();let r=[];if(a.aggregation==="sum"&&a.goalPeriod!=="daily"){let h=0;r=s.map(f=>(h+=f.value,{x:(new Date(f.date).getTime()-i)/(1e3*3600*24),y:h}))}else r=s.map(h=>({x:(new Date(h.date).getTime()-i)/864e5,y:h.value}));const n=r.length,l=r.reduce((h,f)=>h+f.x,0),x=r.reduce((h,f)=>h+f.y,0),c=r.reduce((h,f)=>h+f.x*f.y,0),g=r.reduce((h,f)=>h+f.x*f.x,0),u=n*g-l*l;if(u===0)return null;const d=(n*c-l*x)/u,m=(x-d*l)/n;if(a.goalDirection==="increase"&&d<=0||a.goalDirection==="decrease"&&d>=0||d===0)return null;const b=(a.targetValue-m)/d,p=new Date(i+b*24*60*60*1e3),w=Math.ceil((p-new Date)/(1e3*3600*24));return w<0?null:{date:I(p),daysLeft:w,value:a.targetValue}},ea=()=>{const{user:t}=W(),[a,s]=o.useState([]),[i,r]=o.useState(!0);return o.useEffect(()=>{if(!t){s([]),r(!1);return}const l=fe(Q(E,"artifacts","default-app-id","users",t.uid,"trackers"),re("order","asc"),re("createdAt","desc")),x=De(l,async c=>{const g=c.docs.map(d=>({id:d.id,...d.data(),streak:0,lastDate:null})),u=await Promise.all(g.map(async d=>{const m=Q(E,"artifacts","default-app-id","users",t.uid,"trackers",d.id,"entries"),b=fe(m,re("date","desc")),v=(await we(b)).docs.map(h=>h.data().date),w=Je(v,d.enableStreak);return{...d,streak:w.streak,lastDate:w.lastDate}}));s(u.sort((d,m)=>d.order-m.order)),r(!1)});return()=>x()},[t]),{trackers:a,loading:i,reorderTrackers:async(l,x)=>{const c=Array.from(a),[g]=c.splice(l,1);c.splice(x,0,g);const u=c.map((d,m)=>({...d,order:m}));s(u);try{const d=Be(E);u.forEach(m=>{const b=V(E,"artifacts","default-app-id","users",t.uid,"trackers",m.id);d.update(b,{order:m.order})}),await d.commit()}catch(d){console.error("Failed to reorder:",d)}}}},Xe=o.createContext(),ta=({children:t})=>{const{user:a}=W(),[s,i]=o.useState("blue"),[r,n]=o.useState("dark"),[l,x]=o.useState("graph"),[c,g]=o.useState([]);o.useEffect(()=>{if(!a)return;const v=De(V(E,"artifacts","default-app-id","users",a.uid,"settings","tags"),w=>{if(w.exists()){const h=w.data();h.theme&&i(h.theme),h.mode&&n(h.mode),h.defaultView&&x(h.defaultView),h.list&&g(h.list)}});return()=>v()},[a]),o.useEffect(()=>{const v=document.documentElement,w=document.body;v.classList.remove("dark"),w.classList.remove("bg-zinc-50","bg-zinc-100","bg-zinc-900","bg-black","text-zinc-900","text-white"),r==="light"?w.classList.add("bg-zinc-100","text-zinc-900"):r==="dark"?(v.classList.add("dark"),w.classList.add("bg-zinc-900","text-white")):r==="amoled"&&(v.classList.add("dark"),w.classList.add("bg-black","text-white"))},[r]);const u=async(v,w)=>{v==="theme"&&i(w),v==="mode"&&n(w),v==="defaultView"&&x(w),a&&await Ee(V(E,"artifacts","default-app-id","users",a.uid,"settings","tags"),{[v]:w},{merge:!0})},d=async v=>{g(v),a&&await Ee(V(E,"artifacts","default-app-id","users",a.uid,"settings","tags"),{list:v},{merge:!0})},m=v=>u("mode",v),b=ve[s]||ve.blue,p=r==="amoled";return e.jsx(Xe.Provider,{value:{theme:b,accentColor:s,themeMode:r,defaultView:l,setThemeMode:m,isAmoled:p,tags:c,updateSettings:u,updateTags:d},children:t})},F=()=>o.useContext(Xe),aa=({tracker:t,isActive:a,theme:s,isAmoled:i,onClick:r})=>{const n=t.listDisplayValue||"none";let l=null,x=null;n==="last"&&t.lastValue!==void 0&&t.lastValue!==null?(l=t.lastValue,x="Last"):n==="average"&&t.averageValue!==void 0&&t.averageValue!==null&&(l=t.averageValue,x="Avg");const c=t.enableStreak&&t.streak>0,g=c?"text-orange-500 dark:text-orange-400":"text-zinc-400 dark:text-zinc-600";let u="",d="",m="";return a&&s?i?(u=`bg-black ${s.border} shadow-lg shadow-zinc-900/40 border`,d=s.activeNavText,m="bg-zinc-900 border border-zinc-800 text-zinc-300"):(u=`${s.activeNav} border border-transparent shadow-sm`,d=s.activeNavText,m="bg-white/50 dark:bg-black/20 text-current"):i?(u="bg-black border border-zinc-800 hover:border-zinc-700",d="text-zinc-300",m="bg-zinc-900 border border-zinc-800 text-zinc-400"):(u="bg-white dark:bg-zinc-800 border border-zinc-300 dark:border-zinc-700 hover:border-zinc-400 dark:hover:border-zinc-600 shadow-sm hover:shadow-md",d="text-zinc-900 dark:text-zinc-300",m="bg-zinc-200 dark:bg-zinc-700 text-zinc-700 dark:text-zinc-300"),e.jsxs("div",{onClick:r,className:`p-3 rounded-xl relative flex justify-between items-center transition-all duration-200 cursor-pointer select-none ${u}`,children:[e.jsxs("div",{className:"flex-1 min-w-0 mr-4",children:[e.jsx("h3",{className:`font-bold truncate text-sm ${d}`,children:t.name}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-1",children:[t.showTypeInList!==!1&&e.jsx("span",{className:"text-[10px] text-zinc-500 capitalize",children:t.type}),t.tags&&t.tags.map((b,p)=>e.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[9px] font-medium border opacity-80 ${b.colorClass}`,children:b.name},p))]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[l!==null&&e.jsxs("div",{className:`text-[10px] px-1.5 py-0.5 rounded-md font-mono font-medium ${m}`,children:[e.jsxs("span",{className:"opacity-70 mr-1",children:[x,":"]}),typeof l=="number"?l.toFixed(1):l]}),t.enableStreak&&t.lastDate&&e.jsxs("div",{className:`flex items-center text-[10px] font-medium transition-colors duration-300 ${g}`,children:[e.jsx(je,{className:`w-3 h-3 mr-1 ${c?"fill-current":"fill-none"}`}),e.jsx("span",{children:t.streak||0})]})]})]})},Ze=t=>{const{user:a}=W(),[s,i]=o.useState([]),[r,n]=o.useState(!0);return o.useEffect(()=>{if(!a||!t){i([]),n(!1);return}const l=fe(Q(E,"artifacts","default-app-id","users",a.uid,"trackers",t,"entries"),re("date","desc"),re("timestamp","desc")),x=De(l,c=>{const g=c.docs.map(u=>({id:u.id,...u.data()}));i(g),n(!1)});return()=>x()},[a,t]),{entries:s,loading:r}};rt.register(nt,it,lt,ot,ct,dt,ut,mt,xt,bt);const sa=(t,a,s,i)=>{if(!t||t.length===0)return{chartData:{datasets:[]},minDate:Date.now(),maxDate:Date.now(),lastEntryDate:Date.now(),firstEntryDate:Date.now(),yMin:0,yMax:10};const r=t.map(k=>Number(k.value));let n=Math.min(...r),l=Math.max(...r);a.targetValue&&(n=Math.min(n,a.targetValue),l=Math.max(l,a.targetValue));const x=(l-n)*.1||1,c=n-x,g=l+x,u={};t.forEach(k=>{const C=I(k.date);u[C]||(u[C]=[]),u[C].push(Number(k.value))});const d=Object.keys(u).sort((k,C)=>new Date(k)-new Date(C)),m=new Date(d[0]),b=new Date(d[d.length-1]);let p=new Date(b),v=null;a.showTrendForecast&&t.length>1&&(v=Se(t,a),v&&new Date(v.date)>p&&(p=new Date(v.date)));const w=[],h=[],f=[],N=new Date(m);N.setHours(0,0,0,0),p.setHours(0,0,0,0),b.setHours(0,0,0,0);let y=null,$=null;for(;N<=p;){const k=N.getTime(),C=I(N);if(u[C]){const A=_e(u[C],a.aggregation||"average");w.push({x:k,y:A}),y=A,$=k}else w.push({x:k,y:null});a.goalDirection==="target"&&a.targetValue&&f.push({x:k,y:a.targetValue}),N.setDate(N.getDate()+1)}v&&y!==null&&(h.push({x:$,y}),h.push({x:p.getTime(),y:a.targetValue}));const S={left:0,top:20,right:0,bottom:0},T=[{label:a.name,data:w,borderColor:s.chartLine,backgroundColor:s.chartFill,tension:.1,fill:!0,pointRadius:k=>k.raw?.y===null?0:3,pointHoverRadius:6,spanGaps:!0,normalized:!0,clip:S}];f.length>0&&T.push({label:"Target",data:f,borderColor:i?"#22c55e":"#16a34a",borderDash:[5,5],pointRadius:0,borderWidth:1.5,fill:!1,clip:S}),h.length>0&&T.push({label:"Trend",data:h,borderColor:"#fbbf24",borderDash:[4,4],pointRadius:0,borderWidth:2,spanGaps:!0,fill:!1,clip:S});const D=864e5;return{chartData:{datasets:T},minDate:m.getTime()-D*.05,maxDate:p.getTime()+D,firstEntryDate:m.getTime(),lastEntryDate:b.getTime(),yMin:c,yMax:g}},ra=({minDate:t,maxDate:a,firstEntryDate:s,lastEntryDate:i,yMin:r,yMax:n,gridColor:l,textColor:x,tracker:c,onDateClick:g})=>{const d=(()=>{const b=typeof window<"u"&&window.innerWidth<768?30:60,p=864e5,v=i-b*p,w=i+p;return{min:Math.max(t,v),max:w}})();return{responsive:!0,maintainAspectRatio:!1,animation:!1,layout:{padding:{top:10,bottom:0,left:0,right:10}},interaction:{mode:"nearest",axis:"x",intersect:!1},plugins:{legend:{display:!1},tooltip:{callbacks:{title:m=>Ae(new Date(m[0].parsed.x)),label:m=>m.raw?.y===null?"":`${m.dataset.label}: ${m.raw.y} ${c.unit||""}`},filter:m=>m.raw?.y!==null},zoom:{pan:{enabled:!0,mode:"x",threshold:0},zoom:{wheel:{enabled:!0},pinch:{enabled:!0},mode:"x"},limits:{x:{min:t,max:a},y:{min:r,max:n}}}},scales:{y:{min:r,max:n,grid:{color:l},afterFit:m=>{m.width=40},ticks:{color:x,padding:10,z:10}},x:{type:"time",time:{unit:"day",tooltipFormat:"MMM d, yyyy",displayFormats:{day:"MMM d"}},min:d.min,max:d.max,bounds:"ticks",grid:{display:!1},ticks:{color:x,minRotation:45,maxRotation:45,source:"data",autoSkip:!1,padding:8,callback:function(m,b){const p=this.chart.scales.x,w=(p.max-p.min)/864e5;let h=1;w>14&&(h=2),w>30&&(h=5),w>60&&(h=10),w>180&&(h=30);const f=new Date(m),N=Math.floor((f.getTime()-s)/864e5);return Math.abs(N)%h===0?Ae(f):null}}}},onClick:(m,b,p)=>{if(b.length>0&&g){const v=p.scales.x.getValueForPixel(m.x);g(I(new Date(v)))}}}},na=({entries:t,tracker:a,onDateClick:s})=>{const{theme:i,themeMode:r,isAmoled:n}=F(),l=o.useRef(null),x=o.useMemo(()=>sa(t,a,i,n),[t,a,i,n]),c=n?"#27272a":r==="dark"?"#334155":"#E4E4E7",g=n||r==="dark"?"#A1A1AA":"#71717A",u=o.useMemo(()=>ra({...x,gridColor:c,textColor:g,tracker:a,onDateClick:s}),[x,c,g,a,s]),d=o.useCallback(()=>{l.current?.resetZoom()},[]);return!t||t.length===0?e.jsx("div",{className:"h-full flex items-center justify-center text-zinc-400",children:"No data yet"}):e.jsxs("div",{className:"h-64 w-full relative group",style:{touchAction:"pan-y"},children:[e.jsx(gt,{ref:l,data:x.chartData,options:u}),e.jsx("button",{onClick:d,className:`
                    absolute top-2 right-2 p-1.5 rounded-lg shadow-sm border transition-opacity opacity-0 group-hover:opacity-100
                    ${n?"bg-zinc-900 border-zinc-800 text-zinc-400 hover:text-white":"bg-white border-zinc-200 text-zinc-500 hover:text-zinc-900"}
                `,title:"Reset View",children:e.jsx(ht,{className:"w-3 h-3"})})]})},ia=({entries:t,tracker:a,onDateClick:s})=>{const{theme:i,isAmoled:r}=F(),[n,l]=o.useState(new Date),{daysInMonth:x,startDay:c}=o.useMemo(()=>Ke(n.getFullYear(),n.getMonth()),[n]),g=b=>{const p=new Date(n);p.setMonth(p.getMonth()+b),l(p)},u=o.useMemo(()=>a.showTrendForecast?Se(t,a):null,[t,a]),d=o.useMemo(()=>{const b={};t.forEach(w=>{const h=I(w.date);b[h]||(b[h]=[]),b[h].push(w)});const p=Object.keys(b).sort(),v={};return p.forEach((w,h)=>{const N=b[w].map(D=>D.value);let y=0;a.aggregation==="sum"&&a.goalPeriod==="daily"?y=N.reduce((D,k)=>D+k,0):y=N.reduce((D,k)=>D+k,0)/N.length;let $=null,S=null;if(h>0){const D=p[h-1],k=b[D];a.aggregation==="sum"&&a.goalPeriod==="daily"?S=k.reduce((C,A)=>C+A.value,0):S=k.reduce((C,A)=>C+A.value,0)/k.length}const T=ze(y,a,S);if(T.isHit===!0)$=!0;else if(T.isHit===!1)if(a.goalDirection==="target"&&S!==null){const D=ze(S,a,null);T.diff<D.diff?$=!0:$=!1}else $=!1;v[w]={value:y,isGood:$}}),v},[t,a]),m=[];for(let b=0;b<c;b++)m.push(e.jsx("div",{className:`h-20 md:h-24 rounded-xl ${r?"bg-zinc-900/30":"bg-zinc-50/50 dark:bg-zinc-900/30"}`},`empty-${b}`));for(let b=1;b<=x;b++){const p=new Date(n.getFullYear(),n.getMonth(),b),v=I(p),w=d[v],h=I(new Date)===v,f=u&&u.date===v;let N=`${i.secondary} ${i.border}`,y="text-zinc-500";w?w.isGood===!0?(N=`border-emerald-200 dark:border-emerald-800 ${r?"bg-emerald-900/40":"bg-emerald-50 dark:bg-emerald-900/20"}`,y="text-emerald-700 dark:text-emerald-400"):w.isGood===!1&&(N=`border-red-200 dark:border-red-800 ${r?"bg-red-900/40":"bg-red-50 dark:bg-red-900/20"}`,y="text-red-700 dark:text-red-400"):N=r?"border-zinc-800 bg-zinc-900/50 hover:bg-zinc-900":"border-zinc-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-700/50",f&&(N=`border-amber-400 dark:border-amber-500 ${r?"bg-amber-900/20":"bg-amber-50 dark:bg-amber-900/10"} ring-1 ring-amber-400 z-10`,w||(y="text-amber-600 dark:text-amber-400 font-bold")),m.push(e.jsxs("div",{onClick:()=>s&&s(v),className:`
                    h-20 md:h-24 border rounded-xl p-1 md:p-2 cursor-pointer relative flex flex-col justify-between group 
                    transition-all duration-300 hover:scale-[1.02] hover:shadow-md
                    ${N}
                    ${h?`ring-2 ${i.ring} ring-offset-2 dark:ring-offset-zinc-800`:""}
                `,children:[e.jsx("span",{className:`text-xs md:text-sm font-medium ${w||f?y:"text-zinc-400"}`,children:b}),w?e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:`block text-sm md:text-lg font-bold leading-tight ${r||y.includes("zinc")?"dark:text-white":y}`,children:a.type==="boolean"?w.value?"Yes":"No":w.value.toFixed(a.type==="numeric"?1:0)}),e.jsx("span",{className:"text-[9px] md:text-[10px] text-zinc-500 uppercase tracking-wider",children:a.unit})]}):e.jsx("div",{className:"opacity-0 group-hover:opacity-100 absolute inset-0 flex items-center justify-center text-zinc-300 dark:text-zinc-600 transition-opacity",children:e.jsx(ie,{className:"w-6 h-6"})}),f&&e.jsxs("span",{className:"absolute top-1.5 right-1.5 flex h-2 w-2",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-amber-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-amber-500"})]})]},b))}return e.jsxs("div",{className:"animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold dark:text-white",children:n.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>g(-1),className:"p-2 hover:bg-zinc-100 dark:hover:bg-zinc-700 rounded-lg text-zinc-600 dark:text-zinc-400",children:e.jsx(Le,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>g(1),className:"p-2 hover:bg-zinc-100 dark:hover:bg-zinc-700 rounded-lg text-zinc-600 dark:text-zinc-400",children:e.jsx(ke,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(b=>e.jsx("div",{className:"text-center text-xs font-semibold text-zinc-400 uppercase tracking-wide py-2",children:b},b)),m]})]})},la=({entries:t,tracker:a})=>{const{isAmoled:s}=F(),i=o.useMemo(()=>{const m=t.length,b=new Set(t.map(p=>I(p.date))).size;return{totalLogs:m,uniqueDays:b}},[t]);t.length>0&&t[0];const r=o.useMemo(()=>{if(!t||t.length===0)return null;if(a.goalPeriod==="longTerm")return t[0].value;const m=I(new Date),b=t.filter(p=>I(p.date)===m);return b.length===0?0:_e(b.map(p=>p.value),a.aggregation||"average")},[t,a]),n=o.useMemo(()=>a.showTrendForecast?Se(t,a):null,[t,a]),{streak:l}=o.useMemo(()=>{const m=t.map(b=>I(b.date));return Je(m,a.enableStreak)},[t,a.enableStreak]),x=o.useMemo(()=>r===null?{label:"No Data",isHit:null}:ze(r,a,null),[r,a]);let c="text-zinc-400";x.isHit===!0?c="text-green-500":x.isHit===!1?c="text-red-500":a.goalDirection!=="none"&&(c="text-blue-500");const g=s?"p-4 rounded-xl border border-zinc-800 bg-black":"p-4 rounded-xl shadow-sm border border-zinc-200 dark:border-zinc-700 bg-white dark:bg-zinc-800",u=({label:m,value:b,subtext:p,icon:v,colorClass:w})=>e.jsxs("div",{className:g,children:[e.jsxs("p",{className:"text-sm text-zinc-500 mb-1 flex items-center gap-1 font-medium uppercase text-[10px] tracking-wide",children:[v&&e.jsx(v,{className:`w-3.5 h-3.5 ${w}`}),m]}),e.jsx("p",{className:"text-2xl font-bold dark:text-white truncate",children:b}),p&&e.jsx("p",{className:"text-xs text-zinc-400 mt-1",children:p})]}),d=()=>n?`Est. ${n.daysLeft} days left`:a.goalDirection==="target"?`Target: ${a.targetValue}`:"Direction";return e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 animate-in slide-in-from-bottom-2 duration-500",children:[e.jsx(u,{label:"Active Days",value:i.uniqueDays,subtext:`Total entries: ${i.totalLogs}`,icon:ye,colorClass:"text-blue-500"}),e.jsx(u,{label:a.goalPeriod==="longTerm"?"Latest":"Today",value:r!==null?Number(r).toFixed(a.type==="numeric"||a.type==="percentage"?1:0):"-",subtext:a.unit?a.unit:"No unit",icon:be,colorClass:"text-purple-500"}),e.jsx(u,{label:"Goal",value:x.isHit!==null?x.label:a.goalDirection==="none"?"No Goal":a.goalDirection,subtext:d(),icon:pt,colorClass:c}),e.jsx(u,{label:"Streak",value:a.enableStreak?`${l} Day${l===1?"":"s"}`:"Disabled",icon:je,colorClass:"text-amber-500"})]})},$e=({isOpen:t,onClose:a,title:s,children:i})=>{const{isAmoled:r,theme:n}=F();if(!t)return null;const l=r?"bg-black/90":"bg-zinc-900/60 backdrop-blur-sm",x=r?"bg-black border border-zinc-800":"bg-white dark:bg-zinc-800 shadow-2xl border border-transparent dark:border-zinc-700",c=r?"border-zinc-800":"border-zinc-200 dark:border-zinc-700",g=r?{boxShadow:`0 0 50px -10px ${n.chartLine}40`}:{};return e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center p-4 ${l}`,onClick:a,children:e.jsxs("div",{className:`
            w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh] rounded-2xl
            animate-in fade-in zoom-in-95 duration-200
            ${x}
        `,style:g,onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:`p-6 flex justify-between items-center border-b ${c}`,children:[e.jsx("h2",{className:"text-xl font-bold dark:text-white",children:s}),e.jsx("button",{onClick:a,className:"text-zinc-500 hover:text-zinc-800 dark:hover:text-white transition-colors",children:e.jsx(Ne,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-6 space-y-6 overflow-y-auto custom-scrollbar",children:i})]})})},oa=({value:t,onChange:a})=>{const{theme:s,isAmoled:i}=F(),[r,n]=o.useState(()=>t?new Date(t):new Date);o.useEffect(()=>{t&&n(new Date(t))},[t]);const{daysInMonth:l,startDay:x}=o.useMemo(()=>Ke(r.getFullYear(),r.getMonth()),[r]),c=(u,d)=>{d.preventDefault();const m=new Date(r);m.setMonth(m.getMonth()+u),n(m)},g=[];for(let u=0;u<x;u++)g.push(e.jsx("div",{className:"h-8 md:h-9"},`empty-${u}`));for(let u=1;u<=l;u++){const d=new Date(r.getFullYear(),r.getMonth(),u),m=I(d),b=m===t;g.push(e.jsx("button",{onClick:p=>{p.preventDefault(),a(m)},className:`
                    h-8 md:h-9 w-full rounded-lg text-sm font-medium transition-all active:scale-95 
                    ${b?`${s.primary} shadow-md text-white`:"text-zinc-600 dark:text-zinc-400 hover:bg-zinc-100 dark:hover:bg-zinc-700"}
                `,children:u},u))}return e.jsxs("div",{className:`border rounded-xl p-4 transition-colors ${i?"border-zinc-800 bg-zinc-900":"border-zinc-200 dark:border-zinc-700 bg-zinc-50 dark:bg-zinc-900/50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"font-bold text-zinc-800 dark:text-white",children:r.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:u=>c(-1,u),className:"p-1.5 hover:bg-zinc-200 dark:hover:bg-zinc-700 rounded-lg text-zinc-500",children:e.jsx(Le,{className:"w-4 h-4"})}),e.jsx("button",{onClick:u=>c(1,u),className:"p-1.5 hover:bg-zinc-200 dark:hover:bg-zinc-700 rounded-lg text-zinc-500",children:e.jsx(ke,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[["Su","Mo","Tu","We","Th","Fr","Sa"].map(u=>e.jsx("div",{className:"text-center text-xs font-semibold text-zinc-400 mb-1",children:u},u)),g]})]})},ca=({isOpen:t,onClose:a,tracker:s,initialDate:i})=>{const{user:r}=W(),{entries:n}=Ze(s?.id),{theme:l,isAmoled:x,themeMode:c}=F(),[g,u]=o.useState(i||I(new Date)),[d,m]=o.useState(null);o.useEffect(()=>{t&&(u(i||I(new Date)),m(null))},[t,i]);const b=o.useMemo(()=>n.filter(f=>I(f.date)===g).sort((f,N)=>N.timestamp-f.timestamp),[n,g]),p=async()=>{await xe(V(E,"artifacts","default-app-id","users",r.uid,"trackers",s.id),{updatedAt:te()})},v=async f=>{const N={value:f.value,note:f.note,date:g};try{const y=Q(E,"artifacts","default-app-id","users",r.uid,"trackers",s.id,"entries");f.id&&f.id!=="new"?await xe(V(y,f.id),N):await Ge(y,{...N,timestamp:te()}),await p(),m(null)}catch(y){console.error(y)}},w=async f=>{f!=="new"&&(await He(V(E,"artifacts","default-app-id","users",r.uid,"trackers",s.id,"entries",f)),await p()),m(null)};if(!t||!s)return null;const h=`w-full py-3 rounded-xl font-medium shadow-lg text-white hover:scale-[1.01] active:scale-[0.98] flex items-center justify-center gap-2 ${l.primary}`;return e.jsxs($e,{isOpen:t,onClose:a,title:`Entries for ${s.name}`,isAmoled:x,children:[e.jsx("div",{className:"mb-6",style:{colorScheme:x||c==="dark"?"dark":"light"},children:e.jsx(oa,{value:g,onChange:u,theme:l,isAmoled:x,className:x?"bg-zinc-900 border-zinc-800 text-white":void 0})}),e.jsxs("div",{className:"space-y-4",children:[b.length===0&&d!=="new"&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:`inline-flex p-4 rounded-full mb-4 ${x?"bg-zinc-900":"bg-zinc-100 dark:bg-zinc-800"}`,children:e.jsx(ft,{className:"w-8 h-8 text-zinc-400"})}),e.jsx("p",{className:"text-zinc-500 mb-6",children:"No entries for this day."}),e.jsxs("button",{onClick:()=>m("new"),className:h,children:[e.jsx(ie,{className:"w-5 h-5"})," Log Entry"]})]}),d==="new"&&e.jsx(Me,{tracker:s,onSave:v,onCancel:()=>m(null),theme:l,isAmoled:x}),b.map(f=>d===f.id?e.jsx(Me,{entry:f,tracker:s,onSave:v,onDelete:()=>w(f.id),onCancel:()=>m(null),theme:l,isAmoled:x},f.id):e.jsx(da,{entry:f,tracker:s,onClick:()=>m(f.id),theme:l,isAmoled:x},f.id)),b.length>0&&d!=="new"&&e.jsxs("button",{onClick:()=>m("new"),className:h,children:[e.jsx(ie,{className:"w-5 h-5"})," Add Another"]})]})]})},da=({entry:t,tracker:a,onClick:s,theme:i,isAmoled:r})=>e.jsxs("div",{onClick:s,className:`
        p-4 rounded-xl border flex justify-between items-center cursor-pointer transition-all group
        ${r?"border-zinc-800 bg-black hover:bg-zinc-900":"border-zinc-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 hover:border-zinc-300 shadow-sm hover:shadow-md"}
    `,children:[e.jsxs("div",{className:"flex items-center gap-3 overflow-hidden mr-4",children:[t.note&&e.jsx(Pe,{className:"w-4 h-4 text-zinc-400 shrink-0"}),e.jsx("span",{className:`truncate text-sm ${t.note?"text-zinc-700 dark:text-zinc-300":"text-zinc-400 italic"}`,children:t.note||"No note"})]}),e.jsxs("div",{className:`font-mono font-bold text-lg ${i.text}`,children:[a.type==="boolean"?t.value?"Completed":"Skipped":t.value,(a.type==="numeric"||a.type==="percentage")&&e.jsx("span",{className:"text-xs ml-1 text-zinc-400 font-normal",children:a.unit})]})]}),Me=({entry:t={},tracker:a,onSave:s,onDelete:i,onCancel:r,theme:n,isAmoled:l})=>{const x=t.value!==void 0?String(t.value):a.type==="percentage"?"50":"",[c,g]=o.useState(x),[u,d]=o.useState(t.note||""),m=()=>{if(!c&&c!==0&&c!=="0")return;let v=parseFloat(c);a.type==="boolean"&&(v=c==="true"),s({id:t.id||"new",value:v,note:u})},b={value:c,setValue:g,theme:n,isAmoled:l,tracker:a},p=l?"bg-black border-zinc-800":"bg-white dark:bg-zinc-800 border-zinc-200 dark:border-zinc-700";return e.jsx("div",{className:`p-5 rounded-xl border animate-in fade-in zoom-in-95 duration-200 ${p}`,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[a.type!=="boolean"&&a.type!=="percentage"&&e.jsx("label",{className:"text-xs font-bold text-zinc-500 uppercase mb-1.5 block",children:"Value"}),a.type==="percentage"&&e.jsx(ua,{...b}),a.type==="numeric"&&e.jsx(ma,{...b}),a.type==="boolean"&&e.jsx(xa,{...b}),a.type==="rating"&&e.jsx(ba,{...b})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs font-bold text-zinc-500 uppercase mb-1.5",children:[e.jsx(Pe,{className:"w-3 h-3"})," Note"]}),e.jsx("textarea",{value:u,onChange:v=>d(v.target.value),className:`w-full rounded-xl border px-4 py-3 min-h-[80px] resize-none text-sm focus:outline-none focus:ring-2 ${l?"bg-zinc-900 border-zinc-800 placeholder-zinc-600":"bg-zinc-50 dark:bg-zinc-900 border-zinc-300 dark:border-zinc-700 placeholder-zinc-400"} ${n.ring}`,placeholder:"Add a comment..."})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[i&&e.jsx("button",{onClick:i,className:"p-3 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-xl transition-colors",children:e.jsx(Ce,{className:"w-5 h-5"})}),e.jsx("button",{onClick:r,className:"px-5 py-3 text-zinc-500 font-medium hover:bg-zinc-100 dark:hover:bg-zinc-700 rounded-xl transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:m,disabled:!c&&c!==0&&c!=="0",className:`px-6 py-3 text-white font-medium rounded-xl shadow-lg active:scale-95 disabled:opacity-50 flex items-center ${n.primary}`,children:[e.jsx(wt,{className:"w-4 h-4 mr-2"})," Save"]})]})]})})},ua=({value:t,setValue:a,isAmoled:s})=>{const i=parseInt(t)||0;return e.jsxs("div",{className:"py-2",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center mb-6",children:[e.jsx("span",{className:"text-xs font-bold text-zinc-400 uppercase tracking-widest mb-1",children:"Progress"}),e.jsxs("div",{className:`text-5xl font-black tracking-tighter tabular-nums ${s?"text-white":"text-zinc-900 dark:text-white"}`,children:[i,e.jsx("span",{className:"text-2xl text-zinc-400 ml-0.5",children:"%"})]})]}),e.jsxs("div",{className:"relative h-10 w-full flex items-center px-2",children:[e.jsx("div",{className:"absolute left-0 right-0 h-4 rounded-full overflow-hidden",style:{background:"linear-gradient(to right, #ef4444 0%, #eab308 50%, #22c55e 100%)"},children:e.jsx("div",{className:"absolute inset-0 shadow-inner bg-black/5"})}),e.jsx("input",{type:"range",min:"0",max:"100",value:t,onChange:n=>a(n.target.value),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-20"}),e.jsx("div",{className:"absolute h-9 w-9 bg-white rounded-full shadow-lg border-[3px] border-zinc-100 dark:border-zinc-300 pointer-events-none transition-all duration-75 ease-out z-10",style:{left:`calc(${i}% + (${8-i*.16}px) - 20px)`}})]})]})},ma=({value:t,setValue:a,theme:s,isAmoled:i,tracker:r})=>e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:t,onChange:n=>a(n.target.value),className:`w-full px-4 py-3 text-lg font-mono font-medium rounded-xl border focus:outline-none focus:ring-2 dark:text-white ${i?"bg-zinc-900 border-zinc-800":"bg-zinc-50 dark:bg-zinc-900 border-zinc-300 dark:border-zinc-700"} ${s.ring}`,autoFocus:!0,placeholder:"0"}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-sm font-medium text-zinc-400 pointer-events-none",children:r.unit})]}),xa=({value:t,setValue:a,isAmoled:s})=>{const i=t==="true",r=s?"border-zinc-800 text-zinc-400 hover:bg-zinc-900 bg-transparent":"border-zinc-300 dark:border-zinc-700 text-zinc-500 dark:text-zinc-400 hover:bg-zinc-50 dark:hover:bg-zinc-800 bg-transparent";return e.jsxs("button",{onClick:()=>a("true"),className:`
                w-full py-4 rounded-xl border-2 border-dashed flex items-center justify-center gap-3 transition-all
                ${i?"bg-emerald-500/10 border-emerald-500 text-emerald-600 dark:text-emerald-400":r}
            `,children:[e.jsx("div",{className:`
                w-6 h-6 rounded-full flex items-center justify-center border-2 transition-all
                ${i?"bg-emerald-500 border-emerald-500 text-white":"border-current"}
            `,children:i&&e.jsx(vt,{className:"w-4 h-4"})}),e.jsx("span",{className:"text-lg font-bold",children:i?"Completed":"Mark as Complete"})]})},ba=({value:t,setValue:a})=>e.jsx("div",{className:"flex justify-between px-2 py-2",children:[1,2,3,4,5].map(s=>e.jsx("button",{onClick:()=>a(String(s)),className:`p-1.5 rounded-full transition-all active:scale-90 ${parseInt(t)>=s?"scale-110 drop-shadow-md":"opacity-30 hover:opacity-100"}`,children:e.jsx(zt,{className:`w-8 h-8 ${parseInt(t)>=s?"fill-amber-400 text-amber-400":"text-zinc-400 dark:text-zinc-600"}`})},s))}),ga=({tracker:t,onEdit:a})=>{const{entries:s,loading:i}=Ze(t?.id),{theme:r,isAmoled:n}=F(),[l,x]=o.useState(t?.preferredView||"graph"),[c,g]=o.useState(!1),[u,d]=o.useState(null),m=w=>{d(w),g(!0)},b=()=>{d(null),g(!0)};if(!t)return e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-zinc-400 p-8 text-center h-full",children:[e.jsx(be,{className:"w-16 h-16 mb-4 opacity-20"}),e.jsx("p",{className:"mb-4",children:"Select a tracker from the list to view details."})]});const p=n?"bg-black/80 border-zinc-800":"bg-white/80 dark:bg-zinc-900/80 border-zinc-300 dark:border-zinc-800",v=n?"bg-black border border-zinc-800 shadow-xl shadow-zinc-900/20":"bg-white dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700 shadow-md";return e.jsxs("div",{className:"flex flex-col h-full overflow-hidden relative",children:[e.jsxs("header",{className:`p-6 flex justify-between items-center z-10 sticky top-0 backdrop-blur-md border-b ${p}`,children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("h2",{className:"text-2xl font-bold text-zinc-900 dark:text-white truncate max-w-[200px] sm:max-w-xs",children:t.name}),e.jsx("button",{onClick:a,className:`p-1.5 rounded-lg text-zinc-400 transition-colors ${n?"hover:bg-zinc-900 text-zinc-500":"hover:bg-zinc-200 dark:hover:bg-zinc-800 text-zinc-600"}`,children:e.jsx(Re,{className:"w-4 h-4"})}),t.goalDirection==="target"&&t.targetValue&&e.jsxs("span",{className:`hidden sm:inline-block text-xs font-medium text-zinc-600 dark:text-zinc-500 px-2 py-1 rounded-md border ${n?"bg-black border-zinc-800":"bg-zinc-100 dark:bg-zinc-800 border-zinc-300 dark:border-transparent"}`,children:["Target: ",t.targetValue," ",t.unit]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:`flex rounded-lg p-1 border ${n?"bg-black border-zinc-800":"bg-zinc-100 dark:bg-zinc-800 border-transparent"}`,children:[e.jsx("button",{onClick:()=>x("graph"),className:`p-2 rounded-md transition-all ${l==="graph"?`${n?"bg-zinc-900 text-white":"bg-white dark:bg-zinc-700 shadow"} ${r.text}`:"text-zinc-500"}`,children:e.jsx(ye,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>x("calendar"),className:`p-2 rounded-md transition-all ${l==="calendar"?`${n?"bg-zinc-900 text-white":"bg-white dark:bg-zinc-700 shadow"} ${r.text}`:"text-zinc-500"}`,children:e.jsx(Ve,{className:"w-5 h-5"})})]})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 md:p-8 space-y-6",children:[e.jsxs("button",{onClick:b,className:`w-full py-3 rounded-xl font-medium shadow-lg text-white transition-transform hover:scale-[1.005] active:scale-[0.99] flex items-center justify-center space-x-2 ${r.primary}`,children:[e.jsx(ie,{className:"w-5 h-5"}),e.jsx("span",{children:"Add New Entry"})]}),e.jsxs("div",{className:`p-6 rounded-2xl shadow-lg border min-h-[400px] ${v}`,children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h3",{className:"text-lg font-semibold dark:text-white",children:"Activity Overview"})}),i?e.jsx("div",{className:"h-80 flex items-center justify-center text-zinc-400",children:"Loading history..."}):l==="graph"?e.jsx(na,{entries:s,tracker:t,onDateClick:m}):e.jsx(ia,{entries:s,tracker:t,onDateClick:m})]}),s.length>0&&e.jsx(la,{entries:s,tracker:t})]}),e.jsx(ca,{isOpen:c,tracker:t,initialDate:u,onClose:()=>g(!1)})]})},ue=({value:t,onChange:a,options:s,disabled:i=!1})=>{const[r,n]=o.useState(!1),l=o.useRef(null),x=s.find(g=>g.value===t)||s[0];o.useEffect(()=>{const g=u=>{l.current&&!l.current.contains(u.target)&&n(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]);const c=g=>{a({target:{value:g}}),n(!1)};return e.jsxs("div",{className:`relative ${i?"opacity-50 pointer-events-none":""}`,ref:l,children:[e.jsxs("button",{type:"button",onClick:()=>n(!r),className:"w-full px-4 py-2.5 rounded-xl border border-zinc-200 dark:border-zinc-700 bg-zinc-50 dark:bg-zinc-900 flex items-center justify-between transition-all",children:[e.jsx("span",{className:"text-sm font-medium dark:text-white truncate",children:x?.label}),e.jsx(jt,{className:`w-4 h-4 text-zinc-500 transition-transform ${r?"rotate-180":""}`})]}),r&&e.jsx("div",{className:"absolute left-0 right-0 top-full mt-2 rounded-xl border border-zinc-200 dark:border-zinc-700 shadow-xl z-50 overflow-hidden max-h-60 overflow-y-auto bg-white dark:bg-zinc-800",children:e.jsx("div",{className:"p-1.5 space-y-0.5",children:s.map(g=>e.jsxs("button",{onClick:()=>c(g.value),className:`w-full text-left px-3 py-2 text-sm rounded-lg flex items-center justify-between transition-colors ${g.value===t?"bg-zinc-100 dark:bg-zinc-700 text-zinc-900 dark:text-white":"text-zinc-600 dark:text-zinc-400 hover:bg-zinc-50 dark:hover:bg-zinc-900"}`,children:[g.label,g.value===t&&e.jsx(me,{className:"w-3.5 h-3.5 opacity-70"})]},g.value))})})]})},Ie=({isOpen:t,onClose:a,editTracker:s=null,nextOrder:i=0})=>{const{user:r}=W(),{tags:n,updateTags:l,theme:x,isAmoled:c}=F(),[g,u]=o.useState(""),[d,m]=o.useState("numeric"),[b,p]=o.useState(""),[v,w]=o.useState("stars"),[h,f]=o.useState("increase"),[N,y]=o.useState(""),[$,S]=o.useState("daily"),[T,D]=o.useState(!1),[k,C]=o.useState("none"),[A,R]=o.useState(!1),[G,K]=o.useState(!1),[_,J]=o.useState("average"),[ae,se]=o.useState(""),[Y,X]=o.useState([]),[ge,le]=o.useState(!0),[oe,Z]=o.useState("graph"),[ee,ce]=o.useState(""),[j,M]=o.useState(!1),B=o.useRef(null),L=async(z,P)=>{if(!(!r||!s))try{const O=V(E,"artifacts","default-app-id","users",r.uid,"trackers",s.id);await xe(O,{[z]:P,updatedAt:te()})}catch(O){console.error(`Error updating field ${z}:`,O)}};o.useEffect(()=>{t&&(s?(u(s.name),m(s.type),p(s.unit||""),w(s.ratingSystem||"stars"),f(s.goalDirection||"none"),y(s.targetValue||""),S(s.goalPeriod||"daily"),C(s.listDisplayValue||"none"),R(s.showTypeInList!==void 0?s.showTypeInList:!1),K(s.showTrendForecast||!1),J(s.aggregation||"average"),se(s.tolerance||""),X(s.tags||[]),le(s.enableStreak!==void 0?s.enableStreak:!0),Z(s.preferredView||"graph")):(u(""),m("numeric"),p(""),w("stars"),f("increase"),y(""),S("daily"),C("none"),R(!1),K(!1),J("average"),se(""),X([]),le(!0),Z("graph"),D(!1)),M(!1),B.current&&clearTimeout(B.current))},[t,s?.id]),o.useEffect(()=>()=>{B.current&&clearTimeout(B.current)},[]);const H=z=>{Y.some(P=>P.id===z.id)?X(Y.filter(P=>P.id!==z.id)):X([...Y,z])},Te=()=>{if(!ee.trim())return;const z={id:Date.now(),name:ee,colorClass:qe(n).class};l([...n,z]),X([...Y,z]),ce("")};o.useEffect(()=>{d==="percentage"&&(p("%"),f("target"),y(100))},[d]);const Qe=async()=>{if(!g.trim())return;const z={name:g,type:d,unit:d==="numeric"?b:d==="percentage"?"%":null,ratingSystem:d==="rating"?v:null,goalDirection:h,targetValue:h==="target"&&N?parseFloat(N):null,goalPeriod:$,tolerance:ae?parseFloat(ae):0,tags:Y,listDisplayValue:k,showTypeInList:A,aggregation:_,enableStreak:ge,preferredView:oe,showTrendForecast:G,updatedAt:te()};try{s?await xe(V(E,"artifacts","default-app-id","users",r.uid,"trackers",s.id),z):await Ge(Q(E,"artifacts","default-app-id","users",r.uid,"trackers"),{...z,order:0,createdAt:te()}),a()}catch(P){console.error("Error saving tracker:",P)}},et=async()=>{if(s)try{await He(V(E,"artifacts","default-app-id","users",r.uid,"trackers",s.id)),a()}catch(z){console.error("Error deleting tracker",z)}},tt=()=>{s&&(j?(B.current&&clearTimeout(B.current),et()):(M(!0),B.current=setTimeout(()=>{M(!1)},3e3)))},de=`w-full px-4 py-2 rounded-lg border focus:outline-none focus:ring-2 dark:text-white [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${c?"bg-zinc-900 border-zinc-800":"bg-zinc-50 dark:bg-zinc-900 border-zinc-200 dark:border-zinc-700"} ${x.ring}`,at=`rounded-xl font-medium transition-all duration-200 flex items-center justify-center border border-red-200 dark:border-red-900/30 text-red-600 dark:text-red-400 ${c?"bg-black hover:bg-zinc-900 hover:shadow-lg hover:shadow-red-900/20":"bg-red-50 dark:bg-red-900/10 hover:bg-red-100 dark:hover:bg-red-900/20 hover:shadow-md hover:shadow-red-500/10"}`,he=({label:z,icon:P,value:O,onChange:st})=>e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`p-1.5 rounded-lg ${c?"bg-zinc-900":"bg-zinc-100 dark:bg-zinc-700"}`,children:e.jsx(P,{className:"w-4 h-4 text-zinc-500 dark:text-zinc-400"})}),e.jsx("label",{className:"text-sm font-medium text-zinc-700 dark:text-zinc-300",children:z})]}),e.jsx("button",{onClick:()=>st(!O),className:`w-12 h-6 rounded-full transition-colors relative ${O?x.primary.split(" ")[0]:"bg-zinc-300 dark:bg-zinc-600"}`,children:e.jsx("div",{className:`w-4 h-4 bg-white rounded-full absolute top-1 transition-transform ${O?"left-7":"left-1"}`})})]});return e.jsxs($e,{isOpen:t,onClose:a,title:s?"Edit Tracker":"New Tracker",isAmoled:c,children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-1",children:"Name"}),e.jsx("input",{value:g,onChange:z=>u(z.target.value),className:de,placeholder:"e.g. Water Intake"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2",children:"Default View"}),e.jsx("div",{className:"flex gap-4",children:[{id:"graph",label:"Graph",icon:ye},{id:"calendar",label:"Calendar",icon:Ve}].map(z=>{const P=oe===z.id;let O=P?c?"border-zinc-500 bg-zinc-900 text-white shadow-md shadow-zinc-900/50":"border-zinc-600 bg-zinc-100 dark:bg-zinc-800 text-zinc-900 dark:text-white shadow-sm ring-1 ring-zinc-400 dark:ring-zinc-500":c?"bg-black border-zinc-800 text-zinc-500 hover:border-zinc-700 hover:text-zinc-300":"bg-white dark:bg-zinc-900/50 border-zinc-200 dark:border-zinc-700 text-zinc-500 dark:text-zinc-400 hover:border-zinc-300 dark:hover:border-zinc-600 hover:bg-zinc-50 dark:hover:bg-zinc-800";return e.jsxs("button",{onClick:()=>{Z(z.id),L("preferredView",z.id)},className:`flex-1 py-4 px-2 rounded-xl border flex flex-col items-center justify-center gap-2 transition-all duration-200 ${O}`,children:[e.jsx(z.icon,{className:`w-8 h-8 ${P?"stroke-[2px]":"stroke-[1.5px]"}`}),e.jsx("span",{className:"text-sm font-medium",children:z.label})]},z.id)})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-1",children:"Type"}),e.jsx(ue,{value:d,onChange:z=>m(z.target.value),options:[{value:"numeric",label:"Numeric"},{value:"boolean",label:"Yes / No"},{value:"percentage",label:"Percentage"},{value:"rating",label:"Rating"}],theme:x,isAmoled:c,disabled:!!s})]}),(d==="numeric"||d==="percentage")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-1",children:"Units"}),e.jsx("input",{value:b,onChange:z=>p(z.target.value),className:de,placeholder:"e.g. ml",disabled:d==="percentage"})]}),d==="rating"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-1",children:"System"}),e.jsx(ue,{value:v,onChange:z=>w(z.target.value),options:[{value:"stars",label:"5 Stars"},{value:"colors",label:"Traffic Lights"}],theme:x,isAmoled:c})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2",children:"Goal Direction"}),e.jsx(ue,{value:h,onChange:z=>f(z.target.value),options:[{value:"increase",label:"Increase"},{value:"decrease",label:"Decrease"},{value:"target",label:"Target Value"},{value:"none",label:"None"}],theme:x,isAmoled:c})]}),h==="target"&&d!=="boolean"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2",children:"Target Value"}),e.jsx("input",{type:"number",value:N,onChange:z=>y(z.target.value),className:de,placeholder:"2000"})]})]}),e.jsxs("div",{className:`border rounded-xl overflow-hidden ${c?"border-zinc-800":"border-zinc-200 dark:border-zinc-700"}`,children:[e.jsxs("button",{onClick:()=>D(!T),className:`w-full flex justify-between items-center p-4 font-medium transition-colors ${c?"bg-zinc-900 text-zinc-300 hover:bg-zinc-800":"bg-zinc-50 dark:bg-zinc-900 text-zinc-700 dark:text-zinc-300 hover:bg-zinc-100 dark:hover:bg-zinc-800"}`,children:["Advanced Settings ",e.jsx(ke,{className:`w-4 h-4 transition-transform duration-300 ${T?"rotate-90":""}`})]}),e.jsx("div",{className:`grid transition-[grid-template-rows] duration-300 ease-in-out ${T?"grid-rows-[1fr]":"grid-rows-[0fr]"}`,children:e.jsx("div",{className:"overflow-hidden",children:e.jsxs("div",{className:`p-4 space-y-6 ${c?"bg-black":"bg-white dark:bg-zinc-800"}`,children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2",children:"Goal Cadence"}),e.jsxs("div",{className:`flex rounded-lg p-1 ${c?"bg-zinc-900":"bg-zinc-100 dark:bg-zinc-700"}`,children:[e.jsxs("button",{onClick:()=>{S("daily"),L("goalPeriod","daily")},className:`flex-1 py-2 text-sm font-medium rounded-md transition-all flex items-center justify-center gap-2 ${$==="daily"?"bg-white dark:bg-zinc-600 shadow text-zinc-900 dark:text-white":"text-zinc-500 dark:text-zinc-400"}`,children:[e.jsx(kt,{className:"w-3.5 h-3.5"})," Daily Reset"]}),e.jsxs("button",{onClick:()=>{S("longTerm"),L("goalPeriod","longTerm")},className:`flex-1 py-2 text-sm font-medium rounded-md transition-all flex items-center justify-center gap-2 ${$==="longTerm"?"bg-white dark:bg-zinc-600 shadow text-zinc-900 dark:text-white":"text-zinc-500 dark:text-zinc-400"}`,children:[e.jsx(yt,{className:"w-3.5 h-3.5"})," Long Term"]})]}),e.jsx("p",{className:"text-[10px] text-zinc-500 mt-1.5 px-1",children:$==="daily"?"Goal resets every day. Progress is the sum of daily entries.":"Goal is continuous. Progress is compared to the latest entry."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2",children:"Daily Aggregation"}),e.jsxs("div",{className:`flex rounded-lg p-1 ${c?"bg-zinc-900":"bg-zinc-100 dark:bg-zinc-700"}`,children:[e.jsx("button",{onClick:()=>{J("average"),L("aggregation","average")},className:`flex-1 py-1.5 text-sm font-medium rounded-md transition-all ${_==="average"?"bg-white dark:bg-zinc-600 shadow text-zinc-900 dark:text-white":"text-zinc-500 dark:text-zinc-400"}`,children:"Average"}),e.jsx("button",{onClick:()=>{J("sum"),L("aggregation","sum")},className:`flex-1 py-1.5 text-sm font-medium rounded-md transition-all ${_==="sum"?"bg-white dark:bg-zinc-600 shadow text-zinc-900 dark:text-white":"text-zinc-500 dark:text-zinc-400"}`,children:"Total (Sum)"})]})]}),d==="numeric"&&h==="target"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-1",children:"Goal Tolerance (+/-)"}),e.jsx("input",{type:"number",value:ae,onChange:z=>se(z.target.value),className:de,placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-between items-end mb-3",children:e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300",children:"Assign Tags"})}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("input",{value:ee,onChange:z=>ce(z.target.value),placeholder:"Create new tag...",className:`flex-1 px-3 py-1.5 text-sm rounded-lg border dark:text-white ${c?"bg-zinc-900 border-zinc-800":"dark:bg-zinc-900 dark:border-zinc-700"}`,onKeyDown:z=>z.key==="Enter"&&Te()}),e.jsx("button",{onClick:Te,disabled:!ee.trim(),className:`text-sm px-3 py-1.5 rounded-lg font-medium transition-colors dark:text-white ${c?"bg-zinc-900 hover:bg-zinc-800":"bg-zinc-100 dark:bg-zinc-700 hover:bg-zinc-200"}`,children:"Add"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.map(z=>{const P=Y.some(O=>O.id===z.id);return e.jsx("button",{onClick:()=>H(z),className:`px-3 py-1 rounded-full text-sm border transition-all ${z.colorClass} ${P?"opacity-100 font-semibold shadow-sm scale-105":"opacity-40 hover:opacity-100 grayscale hover:grayscale-0"}`,children:z.name},z.id)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2",children:"List Display Value"}),e.jsx(ue,{value:k,onChange:z=>{C(z.target.value),L("listDisplayValue",z.target.value)},options:[{value:"none",label:"None (Hidden)"},{value:"last",label:"Last Inputted Value"},{value:"average",label:"Average of All Entries"}],theme:x,isAmoled:c})]}),e.jsxs("div",{className:`p-3 rounded-xl border ${c?"border-zinc-800 bg-zinc-900/50":"border-zinc-200 dark:border-zinc-700 bg-zinc-50/50 dark:bg-zinc-900/50"}`,children:[e.jsx(he,{label:"Show Type in Sidebar",icon:Nt,value:A,onChange:z=>{R(z),L("showTypeInList",z)}}),e.jsx("div",{className:`h-px my-1 ${c?"bg-zinc-800":"bg-zinc-200 dark:bg-zinc-700"}`}),e.jsx(he,{label:"Track Streak",icon:je,value:ge,onChange:z=>{le(z),L("enableStreak",z)}}),h!=="none"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`h-px my-1 ${c?"bg-zinc-800":"bg-zinc-200 dark:bg-zinc-700"}`}),e.jsx(he,{label:"Show Trend Forecast",icon:Ct,value:G,onChange:z=>{K(z),L("showTrendForecast",z)}})]})]})]})})})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[s&&e.jsx("button",{onClick:tt,className:`px-4 py-3 ${at} ${j?`transform scale-105 active:scale-100 ${c?"shadow-red-900/40":"shadow-red-500/20"}`:""}`,style:{minWidth:j?"140px":"48px"},children:j?e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"w-5 h-5 mr-2"}),e.jsx("span",{className:"text-sm font-medium",children:"Confirm?"})]}):e.jsx(Ce,{className:"w-5 h-5"})}),e.jsx("button",{onClick:Qe,disabled:!g.trim(),className:`flex-1 py-3 rounded-xl font-medium shadow-lg text-white transition-all active:scale-95 disabled:opacity-50 ${x.primary}`,children:s?"Save Changes":"Create Tracker"})]})]})},ha=()=>{const{user:t}=W(),{theme:a,isAmoled:s}=F(),[i,r]=o.useState("idle"),[n,l]=o.useState(""),x=o.useRef(null),c=async()=>{if(t){r("exporting");try{const p={version:1,timestamp:new Date().toISOString(),exportUser:t.email,trackers:[]},v=Q(E,"artifacts","default-app-id","users",t.uid,"trackers"),h=(await we(v)).docs.map(async $=>{const S=$.data(),T=$.id,D=Q(E,"artifacts","default-app-id","users",t.uid,"trackers",T,"entries"),C=(await we(D)).docs.map(A=>({id:A.id,...A.data()}));return{id:T,...S,entries:C}});p.trackers=await Promise.all(h);const f=new Blob([JSON.stringify(p,null,2)],{type:"application/json"}),N=URL.createObjectURL(f),y=document.createElement("a");y.href=N,y.download=`trackit-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(y),y.click(),document.body.removeChild(y),r("success"),l("Export complete!"),setTimeout(()=>r("idle"),3e3)}catch(p){console.error(p),r("error"),l("Export failed. Check console.")}}},g=()=>x.current?.click(),u=async p=>{const v=p.target.files[0];if(!v)return;r("importing"),l("Reading file...");const w=new FileReader;w.onload=async h=>{try{const f=JSON.parse(h.target.result);if(!f.trackers||!Array.isArray(f.trackers))throw new Error("Invalid file format: Missing trackers array.");const N=Be(E);let y=0;const $=450,S=async()=>{await N.commit(),y=0};for(const T of f.trackers){const{entries:D,id:k,...C}=T,A=V(E,"artifacts","default-app-id","users",t.uid,"trackers",k);if(N.set(A,{...C,updatedAt:te()}),y++,D&&Array.isArray(D))for(const R of D){const{id:G,...K}=R,_=V(E,"artifacts","default-app-id","users",t.uid,"trackers",k,"entries",G);N.set(_,K),y++}}y>$&&console.warn("Large batch detected, commit might fail if over 500 writes."),await N.commit(),r("success"),l("Import successful! Refreshing..."),setTimeout(()=>window.location.reload(),1500)}catch(f){console.error(f),r("error"),l("Import failed. Invalid JSON?")}},w.readAsText(v),p.target.value=""},d=`p-4 rounded-xl border flex flex-col gap-4 ${s?"border-zinc-800 bg-zinc-900/30":"border-zinc-200 dark:border-zinc-700 bg-zinc-50/50 dark:bg-zinc-800/30"}`,m="flex-1 flex flex-col items-center justify-center p-4 rounded-xl border transition-all active:scale-95",b=s?"border-zinc-800 hover:bg-zinc-900":"border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-800";return e.jsxs("div",{className:d,children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold dark:text-white",children:"Data Management"}),i==="error"&&e.jsxs("span",{className:"text-xs text-red-500 flex items-center",children:[e.jsx(Dt,{className:"w-3 h-3 mr-1"})," ",n]}),i==="success"&&e.jsxs("span",{className:"text-xs text-green-500 flex items-center",children:[e.jsx(St,{className:"w-3 h-3 mr-1"})," ",n]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:c,disabled:i==="exporting"||i==="importing",className:`${m} ${b} ${i==="exporting"?"opacity-50":""}`,children:[i==="exporting"?e.jsx(ne,{className:`w-6 h-6 mb-2 animate-spin ${a.text}`}):e.jsx(Fe,{className:`w-6 h-6 mb-2 ${a.text}`}),e.jsx("span",{className:"text-sm font-medium dark:text-white",children:i==="exporting"?"Exporting...":"Export Backup"})]}),e.jsxs("button",{onClick:g,disabled:i==="exporting"||i==="importing",className:`${m} ${b} ${i==="importing"?"opacity-50":""}`,children:[i==="importing"?e.jsx(ne,{className:`w-6 h-6 mb-2 animate-spin ${a.text}`}):e.jsx($t,{className:`w-6 h-6 mb-2 ${a.text}`}),e.jsx("span",{className:"text-sm font-medium dark:text-white",children:i==="importing"?"Importing...":"Import Backup"})]}),e.jsx("input",{type:"file",ref:x,onChange:u,accept:".json",className:"hidden"})]}),e.jsx("p",{className:"text-xs text-zinc-500 text-center",children:"Exporting creates a JSON file of all your trackers and entries. Importing will overwrite or add to existing data."})]})},pa=({isOpen:t,onClose:a})=>{const{user:s}=W(),{themeMode:i,tags:r,theme:n,isAmoled:l,updateSettings:x,updateTags:c,setThemeMode:g}=F(),[u,d]=o.useState(!1),[m,b]=o.useState(s?.displayName||""),[p,v]=o.useState(!1),[w,h]=o.useState(""),[f,N]=o.useState(null),[y,$]=o.useState(""),[S,T]=o.useState(""),[D,k]=o.useState(null),[C,A]=o.useState(!1);o.useEffect(()=>{s&&(b(s.displayName||""),k(s.photoURL||null))},[s,t]);const R=async()=>{if(!m.trim()||m.trim()===s?.displayName){b(s?.displayName||""),d(!1);return}try{await pe(U.currentUser,{displayName:m}),await U.currentUser.reload(),d(!1)}catch(j){console.error(j)}},G=j=>{j.key==="Enter"?(j.preventDefault(),j.target.blur()):j.key==="Escape"&&(b(s?.displayName||""),d(!1))},K=async()=>{if(S.trim()){A(!0);try{U.currentUser&&await pe(U.currentUser,{photoURL:S}),x("avatar",S),k(S),T(""),v(!1)}catch(j){console.error(j)}finally{A(!1)}}},_=async()=>{try{U.currentUser&&await pe(U.currentUser,{photoURL:""}),x("avatar",null),k(null),v(!1)}catch(j){console.error(j)}},J=()=>{if(!w.trim())return;const j={id:Date.now(),name:w,colorClass:qe(r).class};c([...r,j]),h("")},ae=j=>c(r.filter(M=>M.id!==j)),se=j=>{N(j.id),$(j.name)},Y=()=>{y.trim()&&(c(r.map(j=>j.id===f?{...j,name:y}:j)),N(null))},X=j=>{const M=r.find(H=>H.id===j);if(!M)return;const L=(q.findIndex(H=>H.class===M.colorClass)+1)%q.length;c(r.map(H=>H.id===j?{...H,colorClass:q[L].class}:H))},oe=`text-sm rounded-lg border outline-none dark:text-white transition-all ${l?"bg-zinc-900 border-zinc-800 focus:border-zinc-700 placeholder-zinc-600":"bg-white dark:bg-zinc-900 border-zinc-300 dark:border-zinc-700 placeholder-zinc-400 focus:border-zinc-400 dark:focus:border-zinc-500"} px-3 py-2 w-full`,Z=`p-5 rounded-2xl border ${l?"border-zinc-800 bg-zinc-900/20":"border-zinc-200 dark:border-zinc-700 bg-zinc-50/50 dark:bg-zinc-800/20"}`,ee=`my-6 border-t ${l?"border-zinc-800":"border-zinc-200 dark:border-zinc-700"}`,ce=`
        w-full py-3 mt-4 rounded-xl font-medium transition-all duration-200
        border border-red-200 dark:border-red-900/30 text-red-600 dark:text-red-400
        ${l?"bg-black hover:bg-zinc-900 hover:shadow-lg hover:shadow-red-900/20":"bg-white dark:bg-zinc-900 hover:bg-red-50 dark:hover:bg-red-900/10 hover:shadow-md hover:shadow-red-500/10"}
        flex items-center justify-center gap-2
    `;return e.jsxs($e,{isOpen:t,onClose:a,title:"Settings",children:[e.jsxs("div",{className:"flex items-center gap-5 mb-8",children:[e.jsxs("div",{className:"relative group",children:[e.jsxs("button",{onClick:()=>v(!p),className:`
                            w-20 h-20 rounded-full flex items-center justify-center text-3xl shrink-0 overflow-hidden 
                            transition-all ring-4 ring-offset-2 ring-transparent
                            ${p?`ring-${n.primary.split(" ")[0]} ring-offset-zinc-50 dark:ring-offset-zinc-900`:""}
                            ${l?"bg-zinc-900 ring-offset-black":"bg-zinc-100 dark:bg-zinc-700"} 
                        `,children:[D?e.jsx("img",{src:D,alt:"Avatar",className:"w-full h-full object-cover transition-opacity group-hover:opacity-50"}):e.jsx(Oe,{className:"w-10 h-10 text-zinc-400 group-hover:opacity-50 transition-opacity"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:e.jsx(Tt,{className:"w-6 h-6 text-zinc-700 dark:text-white drop-shadow-md"})})]}),p&&e.jsx("div",{className:`absolute -bottom-1 left-1/2 -translate-x-1/2 w-3 h-3 rotate-45 border-t border-l ${l?"bg-zinc-900 border-zinc-800":"bg-white dark:bg-zinc-800 border-zinc-200 dark:border-zinc-700"} z-10`})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:u?e.jsx("input",{value:m,onChange:j=>b(j.target.value),onBlur:R,onKeyDown:G,className:`bg-transparent text-xl font-bold outline-none border-b-2 w-full p-0 transition-colors ${l?"text-white border-zinc-700 focus:border-zinc-500":"text-zinc-900 dark:text-white border-zinc-200 dark:border-zinc-700 focus:border-zinc-400"}`,autoFocus:!0}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"font-bold text-xl dark:text-white truncate",title:s?.displayName,children:s?.displayName||"User"}),e.jsx("button",{onClick:()=>d(!0),className:"p-1.5 rounded-md text-zinc-400 hover:text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-all",children:e.jsx(Re,{className:"w-4 h-4"})})]})}),e.jsx("p",{className:"text-sm text-zinc-500 truncate",children:s?.email})]})]}),p&&e.jsxs("div",{className:`mb-8 -mt-2 animate-in slide-in-from-top-4 fade-in duration-300 ${Z} shadow-lg`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 text-sm font-bold text-zinc-700 dark:text-zinc-200",children:[e.jsx(Et,{className:"w-4 h-4 text-zinc-400"}),"Update Profile Picture"]}),e.jsxs("div",{className:"flex gap-0 shadow-sm rounded-xl overflow-hidden",children:[e.jsx("div",{className:`pl-3 pr-2 flex items-center border-y border-l rounded-l-xl ${l?"bg-zinc-900 border-zinc-800":"bg-zinc-50 dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700"}`,children:e.jsx(At,{className:"w-4 h-4 text-zinc-400"})}),e.jsx("input",{value:S,onChange:j=>T(j.target.value),placeholder:"Paste image URL here...",className:`flex-1 px-3 py-2.5 text-sm outline-none border-y dark:text-white ${l?"bg-zinc-900 border-zinc-800 placeholder-zinc-600":"bg-white dark:bg-zinc-900 border-zinc-300 dark:border-zinc-700 placeholder-zinc-400"}`,autoFocus:!0}),e.jsx("button",{onClick:K,disabled:!S.trim()||C,className:`px-5 py-2 text-sm font-medium text-white border-y border-r rounded-r-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed ${n.primary} border-transparent`,children:C?e.jsx(ne,{className:"w-4 h-4 animate-spin"}):"Save"})]}),e.jsxs("div",{className:"mt-3 flex justify-between items-center",children:[e.jsx("p",{className:"text-xs text-zinc-500",children:"Supports JPG, PNG, GIF URLs."}),D&&e.jsxs("button",{onClick:_,className:"text-xs text-red-500 hover:text-red-600 dark:hover:text-red-400 font-medium flex items-center gap-1.5 px-2 py-1 rounded-md hover:bg-red-50 dark:hover:bg-red-900/10 transition-colors",children:[e.jsx(Ce,{className:"w-3 h-3"})," Remove Picture"]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:Z,children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold mb-4 dark:text-white flex items-center gap-2",children:[e.jsx(Ue,{className:"w-4 h-4 text-zinc-400"})," Theme Mode"]}),e.jsx("div",{className:`flex rounded-xl p-1.5 ${l?"bg-zinc-900":"bg-zinc-100 dark:bg-zinc-900/50 border border-zinc-200 dark:border-zinc-700"}`,children:["light","dark","amoled"].map(j=>e.jsx("button",{onClick:()=>g(j),className:`
                                        flex-1 py-2 text-sm font-medium rounded-lg transition-all capitalize
                                        ${i===j?l?"bg-zinc-800 text-white shadow-md border border-zinc-700":"bg-white dark:bg-zinc-700 shadow text-zinc-900 dark:text-white":"text-zinc-500 dark:text-zinc-400 hover:text-zinc-900 dark:hover:text-zinc-200"}
                                    `,children:j==="amoled"?"True Dark":j},j))})]}),e.jsx("div",{className:ee}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold mb-4 dark:text-white flex items-center gap-2",children:[e.jsx(Mt,{className:"w-4 h-4 text-zinc-400"})," Accent Color"]}),e.jsx("div",{className:"grid grid-cols-6 gap-3",children:Object.entries(ve).map(([j,M])=>{const B=M.primary.split(" ")[0],L=n.label===M.label;return e.jsx("button",{onClick:()=>x("theme",j),className:`
                                            h-10 w-10 mx-auto rounded-full ${B} 
                                            transition-all flex items-center justify-center shadow-sm 
                                            ${L?"ring-2 ring-offset-2 ring-zinc-400 dark:ring-offset-zinc-800 scale-110":"hover:scale-110 hover:shadow-md"}
                                        `,title:M.label,children:L&&e.jsx(me,{className:"w-5 h-5 text-white drop-shadow-sm"})},j)})})]})]}),e.jsxs("div",{className:Z,children:[e.jsx("h3",{className:"font-bold mb-4 dark:text-white",children:"Manage Tags"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("input",{value:w,onChange:j=>h(j.target.value),placeholder:"New Tag Name",className:oe,onKeyDown:j=>j.key==="Enter"&&J()}),e.jsx("button",{onClick:J,disabled:!w.trim(),className:`px-4 py-2 text-sm rounded-lg font-medium transition-colors text-white shadow-md disabled:opacity-50 disabled:shadow-none ${n.primary}`,children:"Add"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(j=>f===j.id?e.jsxs("div",{className:`flex items-center gap-1 border rounded-lg p-1 pr-2 animate-in fade-in zoom-in-95 duration-200 ${l?"border-zinc-800 bg-black":"bg-white dark:bg-zinc-800 border-zinc-200 dark:border-zinc-700 shadow-sm"}`,children:[e.jsx("input",{value:y,onChange:M=>$(M.target.value),className:"w-24 text-sm px-2 outline-none bg-transparent dark:text-white",autoFocus:!0}),e.jsx("button",{onClick:()=>X(j.id),className:`p-1.5 rounded-full transition-colors ${l?"hover:bg-zinc-900":"hover:bg-zinc-100 dark:hover:bg-zinc-700"}`,children:e.jsx("div",{className:`w-3 h-3 rounded-full ${q.find(M=>M.class===j.colorClass)?.dot||"bg-zinc-400"}`})}),e.jsx("button",{onClick:Y,className:"p-1 text-green-500 hover:text-green-600",children:e.jsx(me,{className:"w-3.5 h-3.5"})})]},j.id):e.jsxs("span",{className:`${j.colorClass} pl-3 pr-2 py-1.5 rounded-full text-xs font-bold flex items-center border cursor-pointer hover:shadow-sm hover:scale-105 transition-all select-none`,onClick:()=>se(j),children:[j.name,e.jsx("button",{className:"ml-2 p-0.5 hover:bg-black/10 dark:hover:bg-white/20 rounded-full transition-colors",onClick:M=>{M.stopPropagation(),ae(j.id)},children:e.jsx(Ne,{className:"w-3 h-3"})})]},j.id))})]}),e.jsx(ha,{}),e.jsx("div",{className:`pt-4 border-t ${l?"border-zinc-800":"border-zinc-200 dark:border-zinc-700"}`,children:e.jsxs("button",{onClick:()=>{Jt(U),a()},className:ce,children:[e.jsx(It,{className:"w-4 h-4 mr-2"})," Sign Out"]})})]})]})},fa=()=>{const[t,a]=o.useState(null),[s,i]=o.useState(!1);return o.useEffect(()=>{const n=l=>{l.preventDefault(),console.log("✅ PWA: beforeinstallprompt event FIRED! App is installable."),a(l),i(!0)};return console.log("🔄 PWA: Listening for install event..."),window.addEventListener("beforeinstallprompt",n),window.matchMedia("(display-mode: standalone)").matches&&(console.log("ℹ️ PWA: App is already running in standalone mode."),i(!1)),()=>window.removeEventListener("beforeinstallprompt",n)},[]),{isInstallable:s,install:async()=>{if(console.log("🖱️ PWA: Install button clicked"),!t){console.error("❌ PWA: No deferred prompt found. Cannot trigger install.");return}t.prompt();const{outcome:n}=await t.userChoice;console.log(`PWA: User response: ${n}`),a(null),i(!1)}}},wa=()=>{const{isInstallable:t,install:a}=fa(),{isAmoled:s}=F();return t?e.jsxs("button",{onClick:a,className:`
                w-full flex items-center gap-3 px-4 py-3 rounded-xl font-medium transition-all duration-200
                ${s?"bg-zinc-900 text-zinc-300 hover:bg-zinc-800":"bg-blue-50 text-blue-600 hover:bg-blue-100 dark:bg-blue-900/20 dark:text-blue-400 dark:hover:bg-blue-900/30"}
            `,children:[e.jsx("div",{className:`p-2 rounded-lg ${s?"bg-black":"bg-white dark:bg-blue-900/30"}`,children:e.jsx(Fe,{className:"w-4 h-4"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-sm font-bold",children:"Install App"}),e.jsx("p",{className:"text-[10px] opacity-70",children:"Get the native experience"})]})]}):null},va=()=>{const{user:t}=W(),{trackers:a,loading:s,reorderTrackers:i}=ea(),{theme:r,isAmoled:n,themeMode:l,setThemeMode:x}=F(),[c,g]=o.useState(null),[u,d]=o.useState(!1),[m,b]=o.useState(!1),[p,v]=o.useState(!1),[w,h]=o.useState(!1);o.useEffect(()=>{!c&&a.length>0&&g(a[0].id)},[a,c]);const f=a.find(k=>k.id===c),N=k=>{k.destination&&i(k.source.index,k.destination.index)},y=k=>{g(k),h(!1)},$=()=>{if(l==="light"){const k=localStorage.getItem("lastDarkMode")||"dark";x(k)}else localStorage.setItem("lastDarkMode",l),x("light")};if(s)return e.jsx("div",{className:`h-screen flex items-center justify-center ${n?"bg-black":"bg-zinc-50 dark:bg-zinc-900"}`,children:e.jsx("div",{className:`animate-spin rounded-full h-8 w-8 border-b-2 ${r.text}`})});const S=n?"bg-black text-white":"bg-zinc-200 dark:bg-zinc-900 text-zinc-900 dark:text-white",T=n?"bg-black border-zinc-800":"bg-white dark:bg-zinc-800 border-zinc-300 dark:border-zinc-800",D=n?"bg-black/80 border-zinc-800":"bg-white/80 dark:bg-zinc-900/80 border-zinc-300 dark:border-zinc-800";return e.jsxs("div",{className:`flex h-screen w-full overflow-hidden relative ${S}`,children:[w&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-20 md:hidden backdrop-blur-sm",onClick:()=>h(!1)}),e.jsxs("aside",{className:`
          fixed md:relative top-0 left-0 h-full z-30 w-80 flex flex-col border-r
          transition-transform duration-300 ease-in-out
          ${w?"translate-x-0":"-translate-x-full md:translate-x-0"}
          ${T}
      `,children:[e.jsxs("div",{className:`p-6 border-b flex items-center justify-between ${n?"border-zinc-800":"border-zinc-300 dark:border-zinc-800"}`,children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${r.primary}`,children:e.jsx(be,{className:"w-5 h-5 text-white"})}),e.jsx("h1",{className:"text-xl font-bold",children:"TrackIt"})]}),e.jsx("button",{onClick:()=>h(!1),className:"md:hidden text-zinc-500",children:e.jsx(Ne,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"p-4",children:e.jsxs("button",{onClick:()=>{d(!0),h(!1)},className:`w-full py-3 text-white rounded-xl font-medium shadow-lg transition-all flex items-center justify-center gap-2 ${r.primary}`,children:[e.jsx(ie,{className:"w-5 h-5"})," New Tracker"]})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 pt-4 pb-4",children:a.length===0?e.jsx("div",{className:"text-center py-10 text-zinc-400",children:e.jsx("p",{className:"text-sm",children:"No trackers yet."})}):e.jsx(Lt,{onDragEnd:N,children:e.jsx(Pt,{droppableId:"tracker-list",children:k=>e.jsxs("div",{...k.droppableProps,ref:k.innerRef,className:"space-y-2 pb-2",children:[a.map((C,A)=>e.jsx(Rt,{draggableId:C.id,index:A,children:(R,G)=>e.jsx("div",{ref:R.innerRef,...R.draggableProps,style:{...R.draggableProps.style},className:"outline-none border-none",children:e.jsx("div",{...R.dragHandleProps,className:`
                                                        group relative rounded-xl transition-all duration-200 ease-out
                                                        ${G.isDragging?n?"bg-black shadow-zinc-800":"bg-white dark:bg-zinc-800":"bg-transparent"} 
                                                        ${G.isDragging?"shadow-2xl z-50 scale-[1.02]":"shadow-none"}
                                                    `,children:e.jsx("div",{className:"transition-all duration-200",children:e.jsx(aa,{tracker:C,onClick:()=>y(C.id),isActive:c===C.id,theme:r,isAmoled:n})})})})},C.id)),k.placeholder]})})})}),e.jsx("div",{className:"px-4 pb-2",children:e.jsx(wa,{})}),e.jsxs("div",{className:`p-4 border-t flex items-center gap-2 ${n?"border-zinc-800":"border-zinc-300 dark:border-zinc-600"}`,children:[e.jsxs("button",{onClick:()=>{v(!0),h(!1)},className:`flex-1 flex items-center space-x-3 px-3 py-3 rounded-xl transition-colors text-left group ${n?"hover:bg-zinc-900":"hover:bg-zinc-200 dark:hover:bg-zinc-700"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center shrink-0 overflow-hidden ${n?"bg-zinc-900":"bg-zinc-200 dark:bg-zinc-700"}`,children:t?.photoURL?e.jsx("img",{src:t.photoURL,alt:"Avatar",className:"w-full h-full object-cover"}):e.jsx(Oe,{className:"w-4 h-4 text-zinc-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-sm font-medium truncate ${n?"text-white":"text-zinc-900 dark:text-zinc-100"}`,children:t.displayName||"User"}),e.jsx("p",{className:"text-xs text-zinc-600 dark:text-zinc-500",children:"Settings"})]}),e.jsx(Vt,{className:"w-4 h-4 text-zinc-400 group-hover:text-zinc-600 dark:group-hover:text-zinc-300 transition-colors"})]}),e.jsx("button",{onClick:$,className:`p-3 rounded-xl transition-colors ${n?"hover:bg-zinc-900 text-zinc-400 hover:text-white":"hover:bg-zinc-200 dark:hover:bg-zinc-700 text-zinc-600 dark:text-zinc-400 hover:text-zinc-900 dark:hover:text-white"}`,children:l==="light"?e.jsx(Ue,{className:"w-5 h-5"}):e.jsx(Ft,{className:"w-5 h-5"})})]})]}),e.jsxs("main",{className:"flex-1 flex flex-col h-full overflow-hidden relative",children:[e.jsx("div",{className:`md:hidden p-4 flex items-center justify-between sticky top-0 z-10 backdrop-blur-md border-b ${D}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>h(!0),className:"p-2 -ml-2 rounded-lg text-zinc-600 dark:text-zinc-300",children:e.jsx(Ot,{className:"w-6 h-6"})}),e.jsx("span",{className:"font-bold text-lg",children:"TrackIt"})]})}),e.jsx(ga,{tracker:f,onEdit:()=>b(!0)})]}),e.jsx(Ie,{isOpen:u,onClose:()=>d(!1),nextOrder:a.length}),e.jsx(Ie,{isOpen:m,onClose:()=>b(!1),editTracker:f}),e.jsx(pa,{isOpen:p,onClose:()=>v(!1)})]})};function za(){const{user:t}=W();return t?e.jsx(va,{}):e.jsx(Qt,{})}Ut.createRoot(document.getElementById("root")).render(e.jsx(Bt.StrictMode,{children:e.jsx(Zt,{children:e.jsxs(ta,{children:[" ",e.jsx(za,{})]})})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/TrackIt/service-worker.js").then(t=>{console.log("SW registered: ",t)}).catch(t=>{console.log("SW registration failed: ",t)})});
